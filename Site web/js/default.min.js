const queryString=window.location.search,urlParams=new URLSearchParams(queryString),idMatch=urlParams.get("id");let exist=!1,alternatif=[!1,!1];function SetMaillot(value,maillot,chemin,cote,camp){$.post("/php/joueur.php",{team:value,donnee:cote},(function(data){let team=jQuery.parseJSON(data),i=1;for(const joueur of team.attaquant)$(".Float.Attaquant."+chemin).append('<div class="MaillotG '+camp+'" ><div id="'+maillot+"_"+joueur[2]+'" class="Image"><img src="'+team.chemin+'"/></div><h4 class="Nom">'+SetName(joueur[0])+'</h4><h4 class="Numero">'+joueur[1]+"</h4></div>"),i++;for(const joueur of team.milieu)$(".Float.Milieu."+chemin).append('<div class="MaillotG '+camp+'" ><div id="'+maillot+"_"+joueur[2]+'" class="Image"><img src="'+team.chemin+'"/></div><h4 class="Nom">'+SetName(joueur[0])+'</h4><h4 class="Numero">'+joueur[1]+"</h4></div>"),i++;for(const joueur of team.defenseur)$(".Float.Defenseur."+chemin).append('<div class="MaillotG '+camp+'" ><div id="'+maillot+"_"+joueur[2]+'" class="Image"><img src="'+team.chemin+'"/></div><h4 class="Nom">'+SetName(joueur[0])+'</h4><h4 class="Numero">'+joueur[1]+"</h4></div>"),i++;for(const joueur of team.gardien)$(".Float.Gardien."+chemin).append('<div class="MaillotG '+camp+'" ><div id="'+maillot+"_"+joueur[2]+'" class="Image"><img src="/Site web/img/maillot-gardien.png"/></div><h4 class="Nom">'+SetName(joueur[0])+'</h4><h4 class="Numero">'+joueur[1]+"</h4></div>"),i++}))}$("#BoutonGauche, #BoutonGaucheE").change((function(){let maillot,cote,camp,i=$(this).val();"BoutonGauche"===$(this).attr("id")?(maillot=".MaillotD",cote="CheminMaillotDom",camp="domicile",$("SwitchDOM").prop("checked",!1),alternatif[0]=!1,$(".CategorieDOM").empty(),Selectchange("Dom"),$("#CapDOM").show(),$.when(SetMaillot(i,"MaillotD","CategorieDOM",cote,camp)).done(drag()),RefreshMaillot("DOM")):(maillot=".MaillotDE",cote="CheminMaillotExt",camp="exterieur",$("switchEXT").prop("checked",!1),alternatif[1]=!1,$(".categorieEXT").empty(),Selectchange("Ext"),$("#CapEXT").show(),$.when(SetMaillot(i,"MaillotDE","categorieEXT",cote,camp)).done(drag()),RefreshMaillot("EXT"))}));class posmaillot{constructor(left,botop){this.left=left+"%",this.botop=botop+"%"}}let form442=["none",new posmaillot(39.5,13),new posmaillot(53.5,13),new posmaillot(28,33),new posmaillot(38,33),new posmaillot(55,33),new posmaillot(65,33),new posmaillot(28,27),new posmaillot(38,27),new posmaillot(55,27),new posmaillot(65,27)],form442los=["none",new posmaillot(39.5,13),new posmaillot(53.5,13),new posmaillot(46.5,28),new posmaillot(39,40),new posmaillot(54,40),new posmaillot(46.5,52),new posmaillot(29,30),new posmaillot(39,17),new posmaillot(54,17),new posmaillot(64,30)],formCDM=["none",new posmaillot(46.5,13),new posmaillot(33,33),new posmaillot(46.5,33),new posmaillot(60,33),new posmaillot(39,46),new posmaillot(54,46),new posmaillot(28,27),new posmaillot(39,17),new posmaillot(54,17),new posmaillot(65,27)],form532=["none",new posmaillot(40,10),new posmaillot(53,10),new posmaillot(34,30),new posmaillot(46.5,38),new posmaillot(59.5,30),new posmaillot(28.5,47.5),new posmaillot(36,23),new posmaillot(46.5,18),new posmaillot(57,23),new posmaillot(64.5,32.5)],formarray=[form442,form442los,formCDM,form532];function FormationMaillot(Maillot,leftpos,botoppos,i){i<=6?$(Maillot).animate({left:leftpos,top:botoppos},250):$(Maillot).animate({left:leftpos,bottom:botoppos},250)}$("#BoutonDroit, #BoutonDroitE").change((function(){if("t"===$(this).attr("id").slice(-1))for(array=formarray[$(this).val()],i=1;i<=10;i++)array[i],FormationMaillot("#TerrainMaillot > #Maillot"+i,array[i].left,array[i].botop,i);else for(array=formarray[$(this).val()],i=1;i<=10;i++)array[i],FormationMaillot("#TerrainMaillot > #Maillot"+i+"E",array[i].left,array[i].botop,i)}));let State=0,Precedent,Suivant;function setStep(Back,Current,Next,Step){$("#BackStep").text(Back),$("#SousTitre").text(Current),$("#EtapeText").text("Etape "+Step+"/3"),$("#NextStep").text(Next),drag()}function GoBack(i){iMoins=i--,$("#Etape"+i).toggleClass("Passé"),$("#Etape"+iMoins).toggleClass("PasPasse")}function GoForward(i){iPlus=i++,$("#Etape"+i).toggleClass("PasPasse"),$("#Etape"+iPlus).toggleClass("Passé")}$("#Suivant").click((function(){let valeur=$("#BarreEtape").val();0==State?(GoForward(1),State++,setStep("Paramètres du match","Equipe domicile","Equipe extérieur",2),move(valeur,.66)):1==State?(GoForward(2),State++,setStep("Equipe domicile","Equipe extérieur","Lancement du match",3),move(valeur,1)):($("#Sauvegarder, #Darken").show(),$("#Sauvegarder").css({display:"flex"}),$("#Sauvegarder, #Darken").animate({opacity:1},200))})),$("#Precedent").click((function(){let valeur=$("#BarreEtape").val();if(2==State)GoBack(3),State--,setStep("Paramètres du match","Equipe domicile","Equipe extérieur",2),move(valeur,.66);else if(1==State)GoBack(2),State--,setStep("Menu principal","Paramètres du match","Equipe domicile",1),move(valeur,.33);else if(0==State)return $("#AlerteRetour, #Darken").show(),$("#AlerteRetour, #Darken").animate({opacity:"1"},100),$("#EtapeText").text("Etape 0/3"),void move(valeur,0)}));let Timer=[Precedent,Suivant];function DelayHover(Element,i){clearTimeout(Timer[Timer.indexOf(i)]),Timer[Timer.indexOf(i)]=setTimeout((function(){$(Element).animate({width:"1.2em"},200)}),800)}function RefreshMaillot(side){let target,cote,banc;"DOM"===side?(target="#Etape2>#TerrainMaillot>",cote=".domicile",banc="#Etape2>.MenuDroit>#Droite>div"):(target="#Etape3>#TerrainMaillot>",cote=".exterieur",banc="#Etape3>.MenuDroit>#Droite>div"),$(target+".MaillotT>.Image>img").attr("src","/Site web/img/maillot-blanc.png"),$(target+".MaillotT>.Image>img.OnCap").remove(),$(target+".MaillotT>.Image").removeClass("Taken"),$(target+".MaillotT").draggable({disabled:!0}),$(target+".MaillotT>img.Capitaine").remove(),$(target+".MaillotT>h4").css({opacity:"0"}),$(target+".MaillotT").css({opacity:"0.5"}),$(cote).show(),$(banc).remove()}$("#Suivant, #Precedent").hover((function(){clearTimeout(Timer[Timer.indexOf($(this).attr("id"))]),$(this).animate({width:"9.5em"},200)}),(function(){DelayHover(this,$(this).attr("id"))})),$("#RetourMenu").click((function(){window.location.href="/Site web/index.html"})),$("#RetourPage").click((function(){let valeur=$("#BarreEtape").val();$("#AlerteRetour, #Darken").animate({opacity:"0"},100),setTimeout((function(){$("#AlerteRetour, #Darken").hide()}),100),move(valeur,.33),$("#EtapeText").text("Etape 1/3")}));let remplacant=0,remplacantE=0;function nombreRemplacant(add){1===State?(add?(remplacant++,$("#Etape2>.MenuDroit>#Droite>#ColoneBanc").text("BANC ("+remplacant+"/11)")):(remplacant--,$("#Etape2>.MenuDroit>#Droite>#ColoneBanc").text("BANC ("+remplacant+"/11)")),remplacant>=6?$("#Etape2>.MenuDroit>#Droite>#Warning").text(" "):$("#Etape2>.MenuDroit>#Droite>#Warning").text("Il faut un minimum de 6 remplacants")):(add?(remplacantE++,$("#Etape3>.MenuDroit>#Droite>#ColoneBanc2").text("BANC ("+remplacantE+"/11)")):(remplacantE--,$("#Etape3>.MenuDroit>#Droite>#ColoneBanc2").text("BANC ("+remplacantE+"/11)")),remplacantE>=6?$("#Etape3>.MenuDroit>#Droite>#Warning").text(" "):$("#Etape3>.MenuDroit>#Droite>#Warning").text("Il faut un minimum de 6 remplacants"))}function Selectchange(Select){let value;"Dom"===Select?($("#BoutonGaucheE > option").show(),value=$("#BoutonGauche").val(),$('#BoutonGaucheE > option[value="'+value+'"]').hide()):"Ext"===Select&&($("#BoutonGauche > option").show(),value=$("#BoutonGaucheE").val(),$('#BoutonGauche > option[value="'+value+'"]').hide())}function move(value,nextvalue){if(value<nextvalue){let int=setInterval(frame,22);function frame(){value>=nextvalue?clearInterval(int):(value+=.01,$("#BarreEtape").val(value))}}else{let int=setInterval(frame,22);function frame(){value<=nextvalue?clearInterval(int):(value-=.01,$("#BarreEtape").val(value))}}}function IsVoid(Input,Title){return void 0===Title?""===Input.val()||null===Input.val()?(Input.addClass("Void"),!0):void Input.removeClass("Void"):""===Input.val()||null===Input.val()?(Title.addClass("Red"),!0):void Title.removeClass("Red")}function IsVoidArbitre(){let array=[];return array.push(IsVoid($("#NatArbitreP"))),array.push(IsVoid($("#NomArbitreP"))),array.push(IsVoid($("#NatArbitreSec1"))),array.push(IsVoid($("#NomArbitreSec1"))),array.push(IsVoid($("#NatArbitreSec2"))),array.push(IsVoid($("#NomArbitreSec2"))),-1!==array.indexOf(!0)?($("#Arbitres>h3").addClass("Red"),!0):($("#Arbitres>h3").removeClass("Red"),!1)}function SetName(nom){let array=nom.split(" "),result;if(void 0!==array[1]){let maj;result=array[0][0]+"."+array[1]}else result=nom;return result}$("#AddArbitre").click((function(){$("#MenuArbitre,#Darken").show(),$("#MenuArbitre,#Darken").animate({opacity:"1"},250)})),$("#Back").click((function(){$("#MenuArbitre,#Darken").animate({opacity:"0"},250),setTimeout((function(){$("#MenuArbitre,#Darken").hide()}),250)})),$("#Back").click((function(){IsVoidArbitre()})),$("#SaveFirstStep").click((function(){let array=[];array.push(IsVoid($("#LieuInput"),$("#LieuTitre"))),array.push(IsVoid($("#DatePicker"),$("#DateTitre"))),array.push(IsVoid($("#BoutonGaucheE"),$("#BoutonGaucheE").parent().children("h3"))),array.push(IsVoid($("#BoutonGauche"),$("#BoutonGauche").parent().children("h3"))),array.push(IsVoidArbitre()),-1!==array.indexOf(!0)&&alert("Pour sauvegarder la première étape il est important de remplir tout les champs.")})),$("#SwitchDOM, #switchEXT").change((function(){let check=$(this).prop("checked"),maillot,path,id,alt;"SwitchDOM"===$(this).attr("id")?(maillot=".domicile",path="CheminMaillotDom",id=$("#BoutonGauche").val(),alt=0):(maillot=".exterieur",path="CheminMaillotExt",id=$("#BoutonGaucheE").val(),alt=1),check?($.post("/php/SwitchMaillot.php",{type:"CheminMaillotNeutre",id:id},(function(data){$(".Float.Attaquant>"+maillot+">.Image>img, .Float.Milieu>"+maillot+">.Image>img, .Float.Defenseur>"+maillot+">.Image>img, "+maillot+">.Taken>img, #Droite>"+maillot+">.Image>img").not((function(){if("/Site web/img/maillot-gardien.png"===$(this).attr("src")||"/Site web/img/brassard.png"===$(this).attr("src"))return!0})).attr("src",data)})),alternatif[alt]=!0):($.post("/php/SwitchMaillot.php",{type:path,id:id},(function(data){$(".Float.Attaquant>"+maillot+">.Image>img, .Float.Milieu>"+maillot+">.Image>img, .Float.Defenseur>"+maillot+">.Image>img, "+maillot+">.Taken>img, #Droite>"+maillot+">.Image>img").not((function(){if("/Site web/img/maillot-gardien.png"===$(this).attr("src")||"/Site web/img/brassard.png"===$(this).attr("src"))return!0})).attr("src",data)})),alternatif[alt]=!1)}));let arbitre=["Arbitre1","Arbitre2","Arbitre3"];function hideArbitre(){$("#Arbitre1 > option, #Arbitre2 > option, #Arbitre3 > option").show();for(let i=0;i<arbitre.length;i++)if(null!==$("#"+arbitre[i]).val()){let value=$("#"+arbitre[i]).val();for(let x=0;x<arbitre.length;x++)x!==i&&$("#"+arbitre[x]+'> option[value="'+value+'"]').hide()}}function sauvegarde(DOM,EXT,alt){DOM=JSON.stringify(DOM),EXT=JSON.stringify(EXT);let EquipeDOM=$("#BoutonGauche option:selected").val(),EquipeEXT=$("#BoutonGaucheE option:selected").val();$.post("/php/sauvegardePrepa.php",{DOM:DOM,EXT:EXT,id:idMatch,alt:alt,EquipeDOM:EquipeDOM,EquipeEXT:EquipeEXT},(function(data){}))}$("#Arbitre1, #Arbitre2, #Arbitre3").change((function(){hideArbitre()})),$("#SaveFirstStep").click((function(){let stade=$("#Stade").val(),arbitre1=$("#Arbitre1").val(),arbitre2=$("#Arbitre2").val(),arbitre3=$("#Arbitre3").val(),teamDOM=$("#BoutonGauche").val(),teamEXT=$("#BoutonGaucheE").val(),date=$("#DatePicker").val();exist?$.post("/php/sauvegarde.php",{id:idMatch,stade:stade,arbitre1:arbitre1,arbitre2:arbitre2,arbitre3:arbitre3,teamDOM:teamDOM,teamEXT:teamEXT,date:date},(function(data){})):$.post("/php/sauvegarde.php",{stade:stade,arbitre1:arbitre1,arbitre2:arbitre2,arbitre3:arbitre3,teamDOM:teamDOM,teamEXT:teamEXT,date:date},(function(data){location.href="/Site web/html/CreateMatch.php?id="+data}))})),$(document).ready((function(){null!==idMatch?(exist=!0,$.post("/php/RetrieveMatch.php",{id:idMatch},(function(data){const converted=JSON.parse(data);null===converted||"1"===converted[8]?(alert("Le match sélectionner est déjà préparer ou n'existe pas, veuillez le lancer ou d'en selectionner un autre."),location.href="/index.php"):($("#BoutonGauche").val(converted[1]),$("#BoutonGaucheE").val(converted[2]),$("#Arbitre1").val(converted[3]),$("#Arbitre2").val(converted[4]),$("#Arbitre3").val(converted[5]),$("#DatePicker").val(converted[6]),$("#Stade").val(converted[7]),hideArbitre(),Selectchange("Dom"),Selectchange("Ext"),$("#BoutonGauche, #BoutonGaucheE").trigger("change"),drag())}))):$("#Suivant").hide()})),$("#CancelSave").click((function(){$("#Sauvegarder, #Darken").animate({opacity:0},200),setTimeout((function(){$("#Sauvegarder, #Darken").hide()}),200)})),$("#ConfirmSave").click((function(){let arrayDOM=[];for(let i=1;i<12;i++){let maillot=$("#Maillot"+i).children(".Image").attr("id");if(void 0===maillot)return void alert("Un maillot n'est pas placé pour l'équipe domicile !");if(maillot=parseInt(maillot.split("_")[1]),isNaN(maillot))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();arrayDOM.push(maillot)}let remplacantArrayDOM=[],remplacantDOM=$("#Etape2 > div > #Droite > div").children(".Image");if(remplacantDOM.length<6||remplacantDOM.length>11)return void alert("Il n'y a pas assez de remplacant coté Domicile");for(let i=0;i<remplacantDOM.length;i++){if(id=$(remplacantDOM[i]).attr("id"),id=parseInt(id.split("_")[1]),isNaN(id))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();remplacantArrayDOM.push(id)}let formationDOM=$("#BoutonDroit option:selected").val();if(formationDOM=parseInt(formationDOM),isNaN(formationDOM))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();let capitaineDOM=$("#Etape2").find(".OnCap");if(0===capitaineDOM.length)return void alert("Il n'y à pas de capitaine pour l'équipe a domicile !");if(capitaineDOM.length>1)return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();if(capitaineDOM=capitaineDOM.parent().attr("id"),void 0===capitaineDOM)return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();if(capitaineDOM=capitaineDOM.split("_")[1],isNaN(capitaineDOM))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();arrayDOM.push(formationDOM,capitaineDOM,remplacantArrayDOM);let arrayEXT=[];for(let i=1;i<12;i++){let maillot=$("#Maillot"+i+"E").children(".Image").attr("id");if(void 0===maillot)return void alert("Un maillot n'est pas placé pour l'équipe exterieur !");if(maillot=parseInt(maillot.split("_")[1]),isNaN(maillot))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();arrayEXT.push(maillot)}let remplacantArrayEXT=[],remplacantEXT=$("#Etape3 > div > #Droite > div").children(".Image");if(remplacantEXT.length<6||remplacantEXT.length>11)return void alert("Il n'y a pas assez de remplacant coté exterieur");for(let i=0;i<remplacantEXT.length;i++){if(id=$(remplacantEXT[i]).attr("id"),id=parseInt(id.split("_")[1]),isNaN(id))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();remplacantArrayEXT.push(id)}let formationEXT=$("#BoutonDroitE option:selected").val();if(formationEXT=parseInt(formationEXT),isNaN(formationEXT))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();let capitaineEXT=$("#Etape3").find(".OnCap");if(0===capitaineEXT.length)return void alert("Il n'y à pas de capitaine pour l'équipe a exterieur !");if(capitaineEXT.length>1)return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();if(capitaineEXT=capitaineEXT.parent().attr("id"),void 0===capitaineEXT)return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();if(capitaineEXT=capitaineEXT.split("_")[1],isNaN(capitaineEXT))return alert("Un problème est survenue, la page va etre recharger"),void document.location.reload();arrayEXT.push(formationEXT,capitaineEXT,remplacantArrayEXT);let alt=0;alternatif[0]&&alt++,alternatif[1]&&(alt+=2),sauvegarde(arrayDOM,arrayEXT,alt)}));